<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>진로 나침반 (Career Compass)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body { -webkit-tap-highlight-color: transparent; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fade-in 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-gray-100 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- 1. 아이콘 컴포넌트 (직접 내장하여 오류 방지) ---
        const Icon = ({ children, size = 20, className = "", ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
        );
        const Icons = {
            BookOpen: (p) => <Icon {...p}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></Icon>,
            TrendingUp: (p) => <Icon {...p}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></Icon>,
            Trophy: (p) => <Icon {...p}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></Icon>,
            Save: (p) => <Icon {...p}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></Icon>,
            ChevronRight: (p) => <Icon {...p}><polyline points="9 18 15 12 9 6"/></Icon>,
            Star: (p) => <Icon {...p}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></Icon>,
            ArrowRight: (p) => <Icon {...p}><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></Icon>,
            Activity: (p) => <Icon {...p}><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></Icon>,
            Search: (p) => <Icon {...p}><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></Icon>,
            User: (p) => <Icon {...p}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></Icon>,
            CheckCircle2: (p) => <Icon {...p}><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></Icon>,
            GraduationCap: (p) => <Icon {...p}><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></Icon>,
            X: (p) => <Icon {...p}><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></Icon>,
            Tag: (p) => <Icon {...p}><path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94 .94-2.48 0-3.42L12 2Z"/><circle cx="7" cy="7" r=".5"/></Icon>,
            Swords: (p) => <Icon {...p}><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" y1="19" x2="19" y2="13"/><line x1="16" y1="16" x2="20" y2="20"/><line x1="19" y1="21" x2="21" y2="19"/><polyline points="14.5 6.5 18 3 21 3 21 6 17.5 9.5"/><line x1="5" y1="14" x2="9" y2="18"/><line x1="7" y1="17" x2="4" y2="20"/><line x1="3" y1="19" x2="5" y2="21"/></Icon>,
            Crown: (p) => <Icon {...p}><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></Icon>,
            HelpCircle: (p) => <Icon {...p}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></Icon>,
            Map: (p) => <Icon {...p}><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" y1="2" x2="8" y2="18"/><line x1="16" y1="6" x2="16" y2="22"/></Icon>,
            Briefcase: (p) => <Icon {...p}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></Icon>,
            Lightbulb: (p) => <Icon {...p}><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2.4 1.5-3.8 0-3.2-2.8-5.7-6-5.7s-6 2.5-6 5.7c0 1.4.5 2.8 1.5 3.8.8.8 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></Icon>,
            Trash2: (p) => <Icon {...p}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></Icon>,
            RotateCcw: (p) => <Icon {...p}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></Icon>
        };

        // --- 2. 자체 구현 차트 컴포넌트 (Recharts 제거로 안정성 확보) ---
        const SimpleLineChart = ({ data, topMajors }) => {
            if (!data || data.length === 0) return null;
            const height = 200;
            const width = 300; // 가변 너비 대신 고정 비율 사용 (반응형은 CSS로)
            const padding = 20;
            
            // X축, Y축 계산
            const xStep = (width - padding * 2) / (data.length - 1 || 1);
            const yMax = 5;
            const yStep = (height - padding * 2) / yMax;

            // 색상 팔레트
            const colors = ['#4f46e5', '#ec4899', '#f59e0b', '#10b981', '#6366f1'];

            return (
                <div className="w-full h-[220px] flex items-center justify-center">
                    <svg viewBox={`0 0 ${width} ${height}`} className="w-full h-full overflow-visible">
                        {/* 그리드 라인 */}
                        {[0, 1, 2, 3, 4, 5].map(i => (
                            <line key={i} x1={padding} y1={height - padding - (i * yStep)} x2={width - padding} y2={height - padding - (i * yStep)} stroke="#e2e8f0" strokeWidth="1" />
                        ))}
                        
                        {/* X축 레이블 */}
                        {data.map((d, i) => (
                            <text key={i} x={padding + (i * xStep)} y={height} fontSize="10" fill="#94a3b8" textAnchor="middle">{d.name}</text>
                        ))}

                        {/* 데이터 라인 그리기 (상위 4개 학과) */}
                        {topMajors.map((major, idx) => {
                            const points = data.map((d, i) => {
                                const val = d[major.name] || 0;
                                const x = padding + (i * xStep);
                                const y = height - padding - (val * yStep);
                                return `${x},${y}`;
                            }).join(' ');

                            return (
                                <g key={major.id}>
                                    <polyline points={points} fill="none" stroke={colors[idx % colors.length]} strokeWidth="2" strokeLinecap="round" />
                                    {/* 점 그리기 */}
                                    {data.map((d, i) => {
                                        const val = d[major.name] || 0;
                                        if (val === 0) return null;
                                        const x = padding + (i * xStep);
                                        const y = height - padding - (val * yStep);
                                        return <circle key={i} cx={x} cy={y} r="3" fill={colors[idx % colors.length]} stroke="white" strokeWidth="1" />;
                                    })}
                                </g>
                            );
                        })}
                    </svg>
                </div>
            );
        };

        // --- Data ---
        const MAJOR_DETAILS_DB = {
          '경영학과': { intro: "기업 자원(사람, 돈, 정보)을 효율적으로 관리해 성과를 내는 '종합 예술 학문'입니다.", fit: "논리적 문제 해결과 리더십이 있는 학생, 숫자로 세상을 분석하고 싶은 학생.", truth: "'장사하는 법'만 배우지 않습니다. 통계, 심리, 사회학을 아우르는 과학적 학문입니다.", roadmap: ["1학년: 인문학적 소양 함양", "2학년: 마케팅, 재무, 회계 기초", "3~4학년: 창업 도전, 경영 전략 심화"], career: "대기업 기획팀, 공인회계사(CPA), 경영 컨설턴트, 창업가 등" },
          '국어국문학과': { intro: "우리말과 글, K-콘텐츠의 뿌리를 연구하는 곳입니다.", fit: "책 읽기와 글쓰기를 좋아하고, 우리 문화 콘텐츠 기획에 관심 있는 학생.", truth: "맞춤법만 배우지 않습니다. 언어 데이터 분석, 한국어 교육 등 실용적 분야도 다룹니다.", roadmap: ["1~2학년: 국어학, 현대문학 기초", "3~4학년: 문학 비평, 문화 콘텐츠 기획"], career: "방송 PD, 작가, 기자, 카피라이터, 국어 교사 등" },
          '철학과': { intro: "\"나는 누구인가?\" 같은 근본적인 질문의 답을 논리적으로 찾는 학문입니다.", fit: "깊이 있는 사고와 토론을 즐기며, AI 윤리 등 미래 문제에 관심 있는 학생.", truth: "취업이 어렵지 않습니다. 비판적 사고력은 로스쿨, 전략 기획 등 다양한 분야의 무기입니다.", roadmap: ["1학년: 논리학, 동서양 철학 기초", "2학년: 윤리학, 인식론", "3~4학년: 미학, 사회철학 심화"], career: "법조인, 언론인, 인문학 연구원, 기업 전략 기획가" },
          '한국사학과': { intro: "우리 민족의 역사와 뿌리를 연구하여 현재와 미래를 통찰합니다.", fit: "역사 드라마/영화를 좋아하고, 유적지 답사에 흥미를 느끼는 학생.", truth: "단순 암기가 아닙니다. 사료를 분석해 새로운 의미를 찾아내는 창의적 과정입니다.", roadmap: ["1~2학년: 한국사 개론", "3~4학년: 시대별 심화 연구, 답사 실습"], career: "큐레이터, 역사 교사, 역사 전문 기자, 문화재 연구원" },
          '사학과': { intro: "전 세계 인류가 걸어온 길을 탐구하며 인간 삶 전체를 이해합니다.", fit: "세계 문화와 역사적 사건에 호기심이 많고 열린 마음을 가진 학생.", truth: "과거에만 머물지 않습니다. 과거를 통해 미래를 설계하는 통찰력을 기릅니다.", roadmap: ["1학년: 역사학 입문", "2학년: 동양사, 서양사 기초", "3~4학년: 지역별/주제별 심화 연구"], career: "외교관, 국제기구 전문가, 언론인, 인문학자" },
          '사회학과': { intro: "사회 구조와 사람들의 관계, 사회 문제를 과학적으로 분석합니다.", fit: "사회 현상에 관심이 많고, 더 나은 세상을 만들고 싶은 학생.", truth: "비판만 하지 않습니다. 통계와 데이터 분석을 통해 과학적인 해결책을 제시합니다.", roadmap: ["1~2학년: 사회학 이론, 조사 방법론", "3~4학년: 사회 문제 분석, 빅데이터 사회학"], career: "여론 조사 전문가, 마케터, 정책 분석가, 언론인" },
          '한문학과': { intro: "한자로 기록된 우리 조상들의 지혜와 문화를 현대적으로 계승합니다.", fit: "한자 공부가 재미있고, 옛글 속 숨은 의미 찾기를 즐기는 학생.", truth: "지루하지 않습니다. 고전 스토리는 영화, 게임 등 훌륭한 콘텐츠의 원천입니다.", roadmap: ["1~2학년: 한문 독해, 한문학 개론", "3~4학년: 한시, 고전 번역 실습"], career: "번역가, 고전 연구원, 한문 교사, 콘텐츠 기획자" },
          '영어영문학과': { intro: "세계 공용어인 영어와 영미권 문화를 깊이 있게 탐구합니다.", fit: "영어 원서 읽기를 좋아하고, 글로벌 무대에서 활동하고 싶은 학생.", truth: "회화 학원이 아닙니다. 언어학과 문학을 통해 인간과 문화를 깊이 이해합니다.", roadmap: ["1~2학년: 영어학, 영미문학 기초", "3~4학년: 고급 영어, 번역, 문화 연구"], career: "글로벌 기업, 외교관, 통번역가, 영어 교육 전문가" },
          '독어독문학과': { intro: "철학과 예술의 나라, 독일의 언어와 문화를 연구합니다.", fit: "독일의 철학, 음악, 기술에 관심이 많고 논리적 사고를 즐기는 학생.", truth: "독일어를 몰라도 기초부터 배울 수 있으며, 유럽 비즈니스 전문가로 성장합니다.", roadmap: ["1~2학년: 독일어 기초, 독일 문화", "3~4학년: 독일 문학, 비즈니스 독일어"], career: "유럽계 기업, 외교관, 문화 코디네이터" },
          '불어불문학과': { intro: "예술과 낭만의 언어 프랑스어와 프랑스 문화를 공부합니다.", fit: "문학, 예술, 패션에 관심이 많고 감수성이 풍부한 학생.", truth: "프랑스어는 UN 공용어이자 아프리카 등 성장 잠재력이 큰 지역의 언어입니다.", roadmap: ["1~2학년: 프랑스어 기초", "3~4학년: 프랑스 문화 예술, 지역학"], career: "국제기구, 패션/예술 기획, 외교관" },
          '중어중문학과': { intro: "세계 최대 시장 중국의 언어와 문화를 깊이 있게 배웁니다.", fit: "중국의 급부상과 문화에 관심이 많고 도전적인 학생.", truth: "단어만 외우지 않습니다. 중국의 정치, 경제, 사회를 아우르는 지역 전문가가 됩니다.", roadmap: ["1~2학년: 중국어 기초, 중국학 개론", "3~4학년: 중국 현대 사회, 비즈니스 중국어"], career: "중국 전문 마케터, 무역 전문가, 외교관" },
          '일어일문학과': { intro: "가깝고도 먼 나라 일본의 언어와 사회 문화를 연구합니다.", fit: "일본 콘텐츠(애니, 소설)를 좋아하고 한일 관계에 관심 있는 학생.", truth: "언어뿐만 아니라 일본의 역사와 사회 구조를 분석하는 전문가 과정입니다.", roadmap: ["1~2학년: 일본어 기초", "3~4학년: 일본 문학, 일본 사회론"], career: "일본계 기업, 콘텐츠 번역가, 관광 전문가" },
          '서어서문학과': { intro: "스페인과 중남미 20여 개국의 언어와 문화를 배웁니다.", fit: "중남미의 열정적인 문화에 끌리고 넓은 시장을 개척하고 싶은 학생.", truth: "세계에서 두 번째로 많이 쓰이는 언어로, 글로벌 비즈니스 기회가 매우 많습니다.", roadmap: ["1~2학년: 스페인어 기초", "3~4학년: 중남미 지역학, 비즈니스 스페인어"], career: "중남미 지역 전문가, 해외 영업, 외교관" },
          '언어학과': { intro: "인간 언어의 구조와 원리를 과학적으로 분석합니다.", fit: "언어의 규칙에 호기심이 많고, AI 언어 처리에 관심 있는 학생.", truth: "여러 외국어를 배우는 곳이 아니라, 언어라는 현상 자체를 논리적으로 연구합니다.", roadmap: ["1~2학년: 음성학, 통사론", "3~4학년: 컴퓨터 언어학, 언어 정보 처리"], career: "AI 개발자(NLP), 언어 치료사, 카피라이터" },
          '생명과학부': { intro: "생명 현상의 근본 원리를 DNA부터 생태계까지 탐구합니다.", fit: "생물 실험을 좋아하고 생명의 신비에 호기심이 많은 학생.", truth: "암기 과목이 아닙니다. 가설을 세우고 증명하는 실험과 논리가 중요합니다.", roadmap: ["1학년: 일반생물학", "2학년: 세포생물학, 유전학", "3~4학년: 면역학, 신경생물학"], career: "생명공학 연구원, 제약 회사, 의/치전원 진학" },
          '생명공학부': { intro: "생명 과학 원리를 산업에 응용하여 유용한 제품을 만듭니다.", fit: "기초 과학을 바탕으로 신약이나 기술을 개발하고 싶은 학생.", truth: "공학적 기술(유전자 재조합 등)을 배워 실제 산업 현장에 적용합니다.", roadmap: ["1~2학년: 생명공학 기초", "3~4학년: 바이오 공정, 신약 개발"], career: "바이오시밀러 기업, 식품 대기업, 화장품 연구원" },
          '식품공학과': { intro: "식품의 생산, 가공, 안전성을 과학적으로 연구합니다.", fit: "먹거리에 관심이 많고, 식품이 만들어지는 과학적 원리가 궁금한 학생.", truth: "요리를 배우지 않습니다. 식품의 성분 분석과 공정 설계를 배우는 공학입니다.", roadmap: ["1~2학년: 식품화학, 미생물학", "3~4학년: 식품 가공학, 위생학"], career: "식품 대기업 연구원, 식약처 공무원, 품질 관리자" },
          '환경생태공학부': { intro: "인간과 자연의 공존을 위한 환경 문제 해결책을 연구합니다.", fit: "환경 보호에 관심이 많고 과학적 기술로 지구를 지키고 싶은 학생.", truth: "캠페인만 하지 않습니다. 오염 정화 기술과 생태 복원 공학을 배웁니다.", roadmap: ["1~2학년: 생태학, 환경화학", "3~4학년: 환경 복원, 수질/대기 관리"], career: "환경 공기업, 환경 컨설턴트, ESG 전문가" },
          '식품자원경제학과': { intro: "식량과 환경 자원의 경제적 가치와 효율적 분배를 연구합니다.", fit: "경제학과 환경/식량 문제 모두에 관심이 있는 융합형 인재.", truth: "농사짓는 법이 아닌, 자원 경제와 정책을 다루는 응용 경제학입니다.", roadmap: ["1~2학년: 경제학, 통계학", "3~4학년: 자원 경제, 식품 마케팅"], career: "금융권, 공기업, 식품 기업 마케팅/기획" },
          '정치외교학과': { intro: "정치 현상과 국제 관계를 분석하여 더 나은 사회를 설계합니다.", fit: "사회 이슈 토론을 즐기고 리더십과 정의감이 있는 학생.", truth: "정치인만 되지 않습니다. 사회를 분석하는 눈으로 다양한 분야 리더가 됩니다.", roadmap: ["1~2학년: 정치학 개론", "3~4학년: 국제 정치, 비교 정치"], career: "국회, 언론사, 국제기구, 로스쿨" },
          '경제학과': { intro: "한정된 자원의 효율적 배분과 경제 현상을 연구합니다.", fit: "수리적 사고력이 뛰어나고 사회 현상을 논리적으로 분석하길 좋아하는 학생.", truth: "돈 버는 법만 배우지 않습니다. 사회 전체의 움직임을 수학적으로 모델링합니다.", roadmap: ["1학년: 경제학 원론", "2학년: 미시/거시 경제학", "3~4학년: 계량 경제, 금융"], career: "금융 공기업, 은행/증권사, 회계사, 데이터 분석가" },
          '통계학과': { intro: "데이터를 수집, 분석하여 미래를 예측하는 데이터 과학입니다.", fit: "수학과 컴퓨터를 좋아하고, 데이터 속에서 의미를 찾고 싶은 학생.", truth: "계산만 하지 않습니다. 빅데이터와 AI 시대의 핵심인 데이터 분석을 주도합니다.", roadmap: ["1~2학년: 통계 수학, 프로그래밍", "3~4학년: 데이터 마이닝, 머신러닝"], career: "데이터 사이언티스트, 리스크 매니저, 여론 조사 기관" },
          '행정학과': { intro: "국가 운영과 공공 정책을 연구하여 공익을 실현합니다.", fit: "공공 문제 해결에 관심이 많고 봉사 정신과 리더십이 있는 학생.", truth: "공무원만 되지 않습니다. 공공 기관, 기업 대관 업무 등 진로가 다양합니다.", roadmap: ["1~2학년: 행정학 개론", "3~4학년: 정책학, 인사/재무 행정"], career: "고위 공무원, 공기업, 로스쿨, 정책 전문가" },
          '수학과': { intro: "자연과 사회 현상의 원리를 논리적인 언어인 수로 탐구합니다.", fit: "어려운 문제를 끝까지 파고드는 끈기와 논리적 사고를 가진 학생.", truth: "순수 학문이지만 금융, AI, 암호학 등 첨단 분야의 기초가 됩니다.", roadmap: ["1~2학년: 미적분학, 선형대수", "3~4학년: 해석학, 위상수학, 금융수학"], career: "금융 전문가(퀀트), 암호/보안 전문가, AI 연구원" },
          '물리학과': { intro: "우주와 물질의 가장 근본적인 원리를 탐구하는 기초 과학입니다.", fit: "자연 현상의 원리에 호기심이 많고 수학적 모델링을 즐기는 학생.", truth: "취업이 잘 됩니다. 반도체, 디스플레이 등 첨단 산업의 기반 지식입니다.", roadmap: ["1~2학년: 역학, 전자기학", "3~4학년: 양자역학, 고체물리"], career: "반도체 연구원, 국방 과학 연구소, 에너지 전문가" },
          '화학과': { intro: "물질의 성질과 변화를 분자 수준에서 연구하고 새로운 물질을 만듭니다.", fit: "실험을 좋아하고 꼼꼼하며 새로운 현상 발견을 즐기는 학생.", truth: "단순 암기가 아닙니다. 물질의 반응 원리를 이해하는 논리적 과정입니다.", roadmap: ["1~2학년: 유기/분석 화학", "3~4학년: 물리화학, 생화학"], career: "제약/화장품 연구원, 배터리 소재 개발, 변리사" },
          '지구환경과학과': { intro: "지구의 과거, 현재, 미래 환경과 자원을 연구합니다.", fit: "지구와 우주 자연 현상에 흥미가 많고 야외 탐사를 즐기는 학생.", truth: "돌만 줍지 않습니다. 기후 변화 예측, 자원 탐사 등 첨단 기술을 활용합니다.", roadmap: ["1~2학년: 지질학, 대기과학", "3~4학년: 지구물리, 환경 지질"], career: "자원 개발 공사, 기상청, 환경 연구원" },
          '화공생명공학부': { intro: "화학 공정과 생명 공학을 융합해 유용한 물질을 대량 생산합니다.", fit: "물리, 화학, 생물을 두루 좋아하고 공정 설계에 흥미가 있는 학생.", truth: "실험실 연구뿐만 아니라 거대한 공장을 설계하고 운영하는 법을 배웁니다.", roadmap: ["1~2학년: 화공 양론, 열역학", "3~4학년: 반응 공학, 공정 제어"], career: "정유/석유화학, 배터리/반도체 엔지니어" },
          '신소재공학부': { intro: "첨단 산업의 핵심인 새로운 소재를 개발하고 연구합니다.", fit: "사물의 재료와 성질에 호기심이 많고 신기술에 관심 있는 학생.", truth: "모든 산업의 기초입니다. 반도체, 배터리, 항공우주 소재 등을 다룹니다.", roadmap: ["1~2학년: 재료과학", "3~4학년: 반도체 재료, 나노 소재"], career: "반도체/디스플레이/배터리 소재 연구원" },
          '건축사회환경공학부': { intro: "도시 인프라(도로, 교량, 상하수도)와 환경 시스템을 설계합니다.", fit: "스케일이 큰 구조물과 국토 개발에 관심이 있고 협동심이 강한 학생.", truth: "단순 건설이 아닙니다. 스마트 시티, 환경 정화 등 첨단 기술을 다룹니다.", roadmap: ["1~2학년: 구조 역학, 수리학", "3~4학년: 토질, 환경, 교통 공학"], career: "건설사, 토지주택공사, 구조 설계사, 환경 엔지니어" },
          '건축학과': { intro: "건물의 기능과 미를 고려하여 인간이 머무는 공간을 설계합니다.", fit: "공간에 대한 상상력이 풍부하고 예술과 기술을 융합하고 싶은 학생.", truth: "5년제 과정으로, 설계 디자인 중심의 전문가 교육을 받습니다.", roadmap: ["1~2학년: 건축 디자인 기초", "3~5학년: 건축 설계 스튜디오"], career: "건축가, 인테리어 디자이너, 도시 계획가" },
          '기계공학과': { intro: "4대 역학을 바탕으로 움직이는 모든 기계 장치를 설계합니다.", fit: "기계의 작동 원리에 흥미가 많고 물리 역학을 좋아하는 학생.", truth: "모든 제조업의 기본입니다. 자동차, 로봇, 항공기 등 분야가 매우 넓습니다.", roadmap: ["1~2학년: 4대 역학(고체,유체,열,동)", "3~4학년: 로봇, 제어, 설계"], career: "자동차/중공업/전자 기업 엔지니어, 로봇 연구원" },
          '산업경영공학과': { intro: "공학적 기술에 경영 마인드를 더해 시스템을 효율화합니다.", fit: "전체적인 흐름을 파악하고 최적의 방법을 찾는 것을 즐기는 학생.", truth: "공장의 최적화뿐만 아니라 금융, IT 서비스 기획 등 진출 분야가 넓습니다.", roadmap: ["1~2학년: 통계, 프로그래밍", "3~4학년: 생산 관리, 금융 공학, 데이터 마이닝"], career: "시스템 엔지니어, 품질 관리, 데이터 분석가, 컨설턴트" },
          '전기전자공학과': { intro: "전기 에너지와 전자 정보를 다루는 현대 기술의 핵심입니다.", fit: "눈에 보이지 않는 전기 신호와 컴퓨터 하드웨어 원리에 관심 있는 학생.", truth: "반도체, 통신, AI 하드웨어 등 4차 산업혁명의 기반 기술을 배웁니다.", roadmap: ["1~2학년: 회로 이론, 전자기학", "3~4학년: 반도체, 통신, 제어"], career: "전자/반도체/통신 대기업, 전력 공기업" },
          '융합에너지공학과': { intro: "지속 가능한 미래를 위한 신재생 에너지와 나노 기술을 연구합니다.", fit: "에너지 문제 해결에 사명감이 있고 융합적 사고를 하는 학생.", truth: "태양광, 배터리, 수소 등 미래 에너지 산업의 리더를 키웁니다.", roadmap: ["1~2학년: 나노/에너지 공학 기초", "3~4학년: 에너지 변환/저장 시스템"], career: "배터리/에너지 기업 연구원, 나노 소재 개발" },
          '교육학과': { intro: "인간 성장과 사회 발전을 위한 교육의 이론과 실천을 연구합니다.", fit: "사람을 좋아하고 가르치는 일과 교육 정책에 관심이 많은 학생.", truth: "선생님만 되지 않습니다. 기업 교육 담당자, 교육 공학자 등 다양합니다.", roadmap: ["1~2학년: 교육학 개론, 심리", "3~4학년: 교육 행정, 공학, 상담"], career: "교사, 교육부 공무원, 기업 HRD(인재개발), 교수" },
          '간호학과': { intro: "과학적 지식과 인간애를 바탕으로 건강 회복을 돕는 전문 의료인입니다.", fit: "생명을 존중하고 봉사 정신이 투철하며 침착한 성격의 학생.", truth: "의사의 보조가 아닌 독자적인 전문직이며, 임상 외 다양한 분야로 진출합니다.", roadmap: ["1~2학년: 해부학, 기본 간호", "3~4학년: 임상 간호 실습"], career: "임상 간호사, 보건 교사, 산업 간호사, 보건 공무원" },
          '컴퓨터학과': { intro: "소프트웨어와 컴퓨터 시스템을 연구하여 디지털 세상을 만듭니다.", fit: "논리적 문제 해결을 즐기고 코딩과 신기술에 흥미가 많은 학생.", truth: "코딩은 도구일 뿐, 문제 해결을 위한 알고리즘과 시스템 설계를 배웁니다.", roadmap: ["1~2학년: 프로그래밍, 자료구조", "3~4학년: OS, 네트워크, AI"], career: "SW 개발자, 시스템 엔지니어, IT 창업가" },
          '데이터과학과': { intro: "빅데이터 속에서 가치를 찾아내는 데이터 사이언티스트를 키웁니다.", fit: "수학과 통계를 좋아하고 데이터를 통해 인사이트를 얻고 싶은 학생.", truth: "통계학과 컴퓨터공학을 융합하여 실전 데이터 분석 능력을 기릅니다.", roadmap: ["1~2학년: 데이터 컴퓨팅, 통계", "3~4학년: 머신러닝, 시각화"], career: "데이터 분석가, AI 엔지니어, 금융권 퀀트" },
          '인공지능학과': { intro: "인간 수준의 지능을 가진 컴퓨터 시스템, AI 기술을 선도합니다.", fit: "인공지능의 원리가 궁금하고 미래 기술을 직접 구현하고 싶은 학생.", truth: "단순 활용이 아닌 AI 모델의 핵심 원리와 응용 기술을 깊게 배웁니다.", roadmap: ["1~2학년: 수학, 알고리즘", "3~4학년: 딥러닝, 컴퓨터 비전, NLP"], career: "AI 연구원, 로봇 개발자, 빅테크 기업" },
          '디자인조형학부': { intro: "창의적인 아이디어를 시각화하여 삶을 아름답고 편리하게 만듭니다.", fit: "미적 감각이 뛰어나고 아이디어를 표현하는 것을 즐기는 학생.", truth: "예술적 감성뿐만 아니라 산업 제품을 기획하는 논리적 사고도 필요합니다.", roadmap: ["1학년: 조형 기초", "2학년~: 산업 디자인 / 조형 예술 심화"], career: "제품/UX 디자이너, 아티스트, 디렉터" },
          '국제학부': { intro: "국제 정치, 경제, 법을 융합하여 글로벌 리더를 양성합니다 (영어 강의).", fit: "외국어 능력이 우수하고 국제 이슈와 외교에 관심이 많은 학생.", truth: "영어만 잘하는 것이 아니라 국제 사회의 작동 원리를 전문적으로 배웁니다.", roadmap: ["1~2학년: 국제 관계, 경제", "3~4학년: 국제법, 개발 협력"], career: "국제기구, 다국적 기업, 외교관, 국제 변호사" },
          '글로벌한국융합학부': { intro: "한국의 정치, 경제, 문화를 세계적 관점에서 융합 연구합니다.", fit: "한국 문화에 자부심이 있고 한국을 세계에 알리고 싶은 학생.", truth: "K-Culture뿐만 아니라 한국의 사회 전반을 학문적으로 탐구합니다.", roadmap: ["1~2학년: 한국학 기초", "3~4학년: 공공 외교, 문화 산업"], career: "공공 외교 전문가, 문화 기획자, 한국학 연구자" },
          '미디어학부': { intro: "미디어와 콘텐츠, 커뮤니케이션의 모든 것을 연구합니다.", fit: "세상 소식에 민감하고 창의적인 콘텐츠 제작과 기획을 즐기는 학생.", truth: "방송뿐만 아니라 데이터 저널리즘, 광고 홍보, UX 등 분야가 넓습니다.", roadmap: ["1~2학년: 미디어 입문", "3~4학년: 저널리즘, 광고PR, 영상"], career: "PD, 기자, 광고 기획자, 마케터, 크리에이터" },
          '보건과학대학': { intro: "첨단 과학 기술로 인간의 건강과 환경을 지키는 융합 학문입니다.", fit: "바이오, 헬스케어, 환경 문제 해결에 기여하고 싶은 학생.", truth: "의료 기기, 신약, 환경 정책 등 미래 유망 바이오 헬스 분야를 이끕니다.", roadmap: ["기초 의과학", "공학/정책 융합 심화"], career: "바이오 연구원, 병원 행정, 환경 전문가" },
          '바이오의공학과': { intro: "의학과 공학을 결합해 첨단 의료기기와 기술을 개발합니다.", fit: "공학적 원리로 사람의 생명을 구하는 기술을 만들고 싶은 학생.", truth: "인공 장기, 의료 영상 장비, 뇌공학 등 미래 의학의 핵심 기술입니다.", roadmap: ["1~2학년: 의공학 기초", "3~4학년: 의료 영상, 생체 재료"], career: "의료기기 연구원, 병원 의공학자, 식약처" },
          '바이오시스템의과학과': { intro: "생명 현상을 분자 수준에서 규명하여 질병 치료법을 연구합니다.", fit: "기초 의학과 생명 과학 연구를 통해 난치병을 정복하고 싶은 학생.", truth: "신약 개발과 질병 진단 기술의 기초가 되는 의과학 전문가를 키웁니다.", roadmap: ["1~2학년: 분자생물학", "3~4학년: 면역학, 종양생물학"], career: "의생명 연구원, 제약 회사, 대학원 진학" },
          '보건환경융합과학부': { intro: "환경 유해 인자를 분석하고 건강을 지키는 기술과 정책을 다룹니다.", fit: "깨끗한 환경과 건강한 삶을 위한 과학적 해결책을 찾고 싶은 학생.", truth: "미세먼지, 감염병 등 현대 사회의 환경 보건 이슈를 전문적으로 다룹니다.", roadmap: ["1~2학년: 환경 보건 기초", "3~4학년: 환경 분석, 독성학"], career: "환경 전문가, 보건직 공무원, 산업 위생 관리자" },
          '보건정책관리학과': { intro: "국민 건강 증진을 위한 보건 의료 정책과 병원 경영을 연구합니다.", fit: "의료 복지 시스템과 병원 운영, 사회 정책에 관심이 있는 학생.", truth: "건강한 사회를 만드는 '사회적 의사'인 보건 행정 전문가를 양성합니다.", roadmap: ["1~2학년: 보건 행정, 통계", "3~4학년: 병원 경영, 보건 법규"], career: "보건 행정가, 병원 경영진, 정책 연구원" },
          '자유전공학부': { intro: "인문/사회/자연 등 다양한 전공을 탐색 후 2학년에 진입합니다.", fit: "다양한 학문에 관심이 많고 융합적 사고로 리더가 되고 싶은 학생.", truth: "전공 진입 선택권이 보장되며 법학 전문 대학원 진학률이 높습니다.", roadmap: ["1학년: 공공 거버넌스, 전공 탐색", "2학년~: 주전공 진입"], career: "법조인, 고위 공직자, 융합 전문가" },
          '스마트보안학부': { intro: "초연결 사회의 안전을 지키는 융합 보안 전문가를 양성합니다.", fit: "IT 기술과 사회 안전, 법/정책에 두루 관심이 있는 학생.", truth: "해킹 방어뿐만 아니라 보안 정책, 디지털 수사 등 보안의 전 영역을 다룹니다.", roadmap: ["1~2학년: 보안 기초, 암호", "3~4학년: 융합 보안 프로젝트"], career: "보안 컨설턴트, 정보 보호 전문가, 수사관" },
          '사이버국방학과': { intro: "상위 1% 엘리트 사이버 보안 장교를 양성합니다 (국방부 계약).", fit: "애국심이 투철하고 최고의 화이트 해커가 되고 싶은 학생.", truth: "졸업 후 장교로 임관하여 국가 안보의 최전선에서 사이버 전을 수행합니다.", roadmap: ["1~2학년: 컴퓨터/보안 기초", "3~4학년: 사이버 전술, 해킹 방어"], career: "사이버 국방 장교, 제대 후 보안 전문가" },
          '심리학부': { intro: "인간의 마음과 행동을 과학적 방법(실험, 통계)으로 연구합니다.", fit: "사람에 대한 호기심과 데이터를 분석하는 과학적 사고를 가진 학생.", truth: "문과지만 이과적 소양(통계, 뇌과학)이 매우 중요한 과학입니다.", roadmap: ["1~2학년: 심리학 개론, 통계", "3~4학년: 임상/상담/인지/산업 심리"], career: "상담사, 임상 심리사, UX 리서처, 마케터" },
          '스마트모빌리티학부': { intro: "미래형 이동 수단(자율주행, 수소차) 전문가를 키웁니다 (현대차 계약).", fit: "자동차와 AI, 차세대 에너지 기술에 모두 관심이 있는 학생.", truth: "학사+석사 5년 통합 과정으로 졸업 후 현대차 연구원으로 입사합니다.", roadmap: ["1~3학년: 기계/전자/SW 융합", "4~5학년: 현장 실무 프로젝트"], career: "현대자동차 연구개발본부 핵심 연구원" }
        };

        const RAW_DATA = [
          { college: '경영대학', majors: ['경영학'] },
          { college: '문과대학', majors: ['국어국문학', '철학', '한국사학', '사학', '사회학', '한문학', '영어영문학', '독어독문학', '불어불문학', '중어중문학', '일어일문학', '서어서문학', '언어학'] },
          { college: '생명과학대학', majors: ['생명과학부', '생명공학부', '식품공학', '환경생태공학부', '식품자원경제학'] },
          { college: '정경대학', majors: ['정치외교학', '경제학', '통계학', '행정학'] },
          { college: '공과대학', majors: ['화공생명공학부', '신소재공학부', '건축사회환경공학부', '건축학', '기계공학', '산업경영공학', '전기전자공학', '융합에너지공학', '반도체공학과'] },
          { college: '이과대학', majors: ['수학과', '물리학', '화학과', '지구환경과학'] },
          { college: '사범대학', majors: ['교육학'] },
          { college: '간호대학', majors: ['간호학'] },
          { college: '정보대학', majors: ['컴퓨터학과', '데이터과학과', '인공지능학과'] },
          { college: '디자인조형학부', majors: ['디자인조형학부'] },
          { college: '국제대학', majors: ['국제학부', '글로벌한국융합학부'] },
          { college: '미디어학부', majors: ['미디어학부'] },
          { college: '보건과학대학', majors: ['바이오의공학', '바이오시스템의과학', '보건환경융합과학부', '보건정책관리학'] },
          { college: '자유전공학부', majors: ['자유전공학부'] },
          { college: '스마트보안학부', majors: ['사이버국방학과', '스마트보안학부'] },
          { college: '심리학부', majors: ['심리학부'] },
          { college: '스마트모빌리티학부', majors: ['스마트모빌리티학부'] },
        ];

        const MAJORS = [];
        const COLLEGES = ['전체', ...RAW_DATA.map(d => d.college)];

        RAW_DATA.forEach((group, groupIdx) => {
          group.majors.forEach((majorName, majorIdx) => {
            let displayName = majorName;
            if (displayName.endsWith('학')) {
              displayName += '과';
            }

            const details = MAJOR_DETAILS_DB[displayName];

            MAJORS.push({
              id: `${groupIdx}-${majorIdx}`,
              name: displayName,
              category: group.college, 
              tags: [`#${group.college.slice(0, 2)}`, `#전공`], 
              desc: details ? details.intro.slice(0, 60) + "..." : `${group.college} 소속의 ${displayName} 전공입니다. 학문에 대한 깊이 있는 탐구와 실무 능력을 기릅니다.`,
              details: details 
            });
          });
        });

        const INITIAL_HISTORY = [
          { 
            date: '2023-03-01', 
            ratings: { '0-0': 5, '3-1': 4, '8-0': 2 }, 
            note: '1학년 1학기: 경영과 경제에 관심' 
          },
          { 
            date: '2023-09-15', 
            ratings: { '0-0': 4, '3-1': 3, '8-0': 4, '8-2': 5 }, 
            note: '1학년 2학기: IT 기술에 흥미가 생김' 
          },
        ];

        function App() {
            const [activeTab, setActiveTab] = useState('explore'); 
            const [selectedCollege, setSelectedCollege] = useState('전체');
            const [history, setHistory] = useState(INITIAL_HISTORY);
            const [toast, setToast] = useState(null);
            
            const [selectedMajor, setSelectedMajor] = useState(null);
            
            const [showProfileModal, setShowProfileModal] = useState(false);

            const [tournamentState, setTournamentState] = useState('idle'); 
            const [candidates, setCandidates] = useState([]); 
            const [nextRoundCandidates, setNextRoundCandidates] = useState([]); 
            const [currentMatchIndex, setCurrentMatchIndex] = useState(0); 
            const [winner, setWinner] = useState(null);
            const [eliminatedCandidates, setEliminatedCandidates] = useState([]);

            const todayStr = new Date().toISOString().split('T')[0];

            const todayRecord = useMemo(() => {
                return history.find(h => h.date === todayStr) || { ratings: {} };
            }, [history, todayStr]);

            const progressStats = useMemo(() => {
                const total = MAJORS.length;
                const currentRatings = todayRecord.ratings || {};
                const ratedCount = Object.values(currentRatings).filter(v => v > 0).length;
                const percentage = Math.round((ratedCount / total) * 100);
                return { total, ratedCount, percentage };
            }, [todayRecord]);

            const handleRatingChange = (id, value) => {
                const val = parseInt(value);
                setHistory(prevHistory => {
                const todayIndex = prevHistory.findIndex(h => h.date === todayStr);
                let newHistory = [...prevHistory];
                if (todayIndex >= 0) {
                    newHistory[todayIndex] = {
                    ...newHistory[todayIndex],
                    ratings: { ...newHistory[todayIndex].ratings, [id]: val }
                    };
                } else {
                    newHistory.push({
                    date: todayStr,
                    ratings: { [id]: val },
                    note: `기록일: ${todayStr}`
                    });
                }
                return newHistory;
                });
            };

            const showToast = (msg, type = 'success') => {
                setToast(null);
                setTimeout(() => {
                setToast({ msg, type });
                setTimeout(() => setToast(null), 1500);
                }, 50);
            };

            const handleResetData = () => {
                if (window.confirm("정말로 모든 평가 기록을 초기화하시겠습니까?\n이 작업은 되돌릴 수 없습니다.")) {
                    setHistory([{
                        date: todayStr,
                        ratings: {},
                        note: `기록일: ${todayStr}`
                    }]);
                    setShowProfileModal(false);
                    showToast("모든 기록이 초기화되었습니다.", "success");
                }
            };

            const handleResetToday = () => {
                if (window.confirm("오늘의 평가 기록만 초기화하시겠습니까?")) {
                setHistory(prevHistory => {
                    const todayIndex = prevHistory.findIndex(h => h.date === todayStr);
                    let newHistory = [...prevHistory];
                    
                    if (todayIndex >= 0) {
                    newHistory[todayIndex] = {
                        ...newHistory[todayIndex],
                        ratings: {} 
                    };
                    }
                    return newHistory;
                });
                setShowProfileModal(false);
                showToast("오늘의 기록이 초기화되었습니다.", "success");
                }
            };

            const topMajors = useMemo(() => {
                const lastRecord = history[history.length - 1];
                if (!lastRecord || !lastRecord.ratings) return [];
                
                return Object.entries(lastRecord.ratings)
                .map(([id, score]) => {
                    const major = MAJORS.find(m => m.id === id);
                    return major ? { ...major, score } : null;
                })
                .filter(m => m && m.score > 0) 
                .sort((a, b) => b.score - a.score)
                .slice(0, 8); 
            }, [history]);

            const startTournament = () => {
                if (topMajors.length < 2) {
                showToast("최소 2개 이상의 학과를 평가해주세요!", "error");
                return;
                }
                const roundSize = Math.pow(2, Math.floor(Math.log2(topMajors.length)));
                const roundCandidates = topMajors.slice(0, roundSize);
                const shuffled = [...roundCandidates].sort(() => Math.random() - 0.5);
                
                setCandidates(shuffled);
                setNextRoundCandidates([]);
                setEliminatedCandidates([]); 
                setCurrentMatchIndex(0);
                setTournamentState('playing');
                setWinner(null);
            };

            const selectWinner = (selectedMajor) => {
                const newNextRound = [...nextRoundCandidates, selectedMajor];
                setNextRoundCandidates(newNextRound);

                const currentPair = [candidates[currentMatchIndex], candidates[currentMatchIndex + 1]];
                const loser = currentPair.find(c => c.id !== selectedMajor.id);
                setEliminatedCandidates(prev => [...prev, loser]);

                if (currentMatchIndex + 2 >= candidates.length) {
                if (newNextRound.length === 1) {
                    setWinner(newNextRound[0]);
                    setTournamentState('finished');
                } else {
                    setCandidates(newNextRound);
                    setNextRoundCandidates([]);
                    setCurrentMatchIndex(0);
                }
                } else {
                setCurrentMatchIndex(prev => prev + 2);
                }
            };

            const resetTournament = () => {
                setTournamentState('idle');
                setWinner(null);
            };

            const displayedData = useMemo(() => {
                let targetColleges = RAW_DATA;
                if (selectedCollege !== '전체') {
                targetColleges = RAW_DATA.filter(group => group.college === selectedCollege);
                }

                return targetColleges.map(group => {
                const groupMajors = MAJORS.filter(m => m.category === group.college);
                const sortedMajors = [...groupMajors].sort((a, b) => {
                    const scoreA = todayRecord.ratings[a.id] || 0;
                    const scoreB = todayRecord.ratings[b.id] || 0;
                    if ((scoreA > 0 && scoreB > 0) || (scoreA === 0 && scoreB === 0)) {
                        return a.id.localeCompare(b.id);
                    }
                    return scoreA === 0 ? -1 : 1;
                });

                return {
                    college: group.college,
                    majors: sortedMajors
                };
                });
            }, [selectedCollege, todayRecord.ratings]);

            const handleCardClick = (major, e) => {
                if (e.target.tagName === 'INPUT') return;
                setSelectedMajor(major);
            };

            return (
                <div className="min-h-screen bg-gray-100 flex justify-center items-center font-sans selection:bg-indigo-100 overflow-hidden">
                <div className="w-full max-w-md bg-slate-50 h-[100dvh] shadow-2xl flex flex-col relative overflow-hidden md:rounded-3xl md:h-[90vh] md:border-8 md:border-gray-900">
                    
                    <div className="h-0 md:h-1 bg-gray-900 w-full absolute top-0 z-50"></div>

                    <header className="bg-white border-b border-slate-100 px-5 py-4 flex items-center justify-between sticky top-0 z-20 shadow-sm">
                    <div className="flex items-center gap-2">
                        <div className="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-bold text-sm shadow-indigo-200 shadow-md">
                        <Icons.GraduationCap size={18} />
                        </div>
                        <span className="font-bold text-lg text-slate-900">학과 탐색</span>
                    </div>
                    <button 
                        onClick={() => setShowProfileModal(true)}
                        className="text-slate-400 hover:text-indigo-600 transition-colors"
                    >
                        <Icons.User size={24} />
                    </button>
                    </header>

                    <main className="flex-1 overflow-y-auto pb-24 scrollbar-hide bg-slate-50">
                        {activeTab === 'explore' && (
                        <div className="animate-fade-in pb-4">
                            <div className="bg-white border-b border-slate-100 sticky top-0 z-10 shadow-sm">
                            <div className="flex gap-2 px-5 py-3 overflow-x-auto scrollbar-hide">
                                {COLLEGES.map((college, idx) => (
                                <button
                                    key={idx}
                                    onClick={() => setSelectedCollege(college)}
                                    className={`px-4 py-2.5 rounded-full text-xs font-bold transition-all whitespace-nowrap border flex-shrink-0 ${
                                    selectedCollege === college
                                        ? 'bg-indigo-600 text-white shadow-md shadow-indigo-200 border-indigo-600'
                                        : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-50'
                                    }`}
                                >
                                    {college}
                                </button>
                                ))}
                            </div>

                            <div className="px-5 py-3 bg-slate-50 border-t border-slate-100">
                                <div className="flex justify-between items-end mb-1.5">
                                <span className="text-xs font-bold text-slate-500">전체 평가 진도율</span>
                                <span className="text-xs font-bold text-indigo-600">
                                    {progressStats.ratedCount} / {progressStats.total} ({progressStats.percentage}%)
                                </span>
                                </div>
                                <div className="w-full h-2 bg-slate-200 rounded-full overflow-hidden">
                                <div 
                                    className="h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-500 ease-out"
                                    style={{ width: `${progressStats.percentage}%` }}
                                ></div>
                                </div>
                                {progressStats.percentage === 100 && (
                                <div className="mt-2 text-center text-xs text-green-600 font-bold animate-pulse">
                                    🎉 모든 학과 평가 완료!
                                </div>
                                )}
                            </div>
                            </div>

                            <div className="px-5 pt-6 space-y-4">
                            {displayedData.map((group) => (
                                <div key={group.college}>
                                <div className="space-y-4">
                                    {group.majors.map((majorObj) => {
                                    const isRated = (todayRecord.ratings[majorObj.id] || 0) > 0;

                                    return (
                                        <div 
                                        key={majorObj.id} 
                                        onClick={(e) => handleCardClick(majorObj, e)}
                                        className={`bg-white rounded-2xl p-5 shadow-sm border active:scale-[0.98] transition-all cursor-pointer relative group ${
                                            isRated 
                                            ? 'border-indigo-100 bg-indigo-50/30'
                                            : 'border-slate-100 hover:border-indigo-200'
                                        }`}
                                        >
                                        <div className="flex justify-between items-start mb-2">
                                            <div>
                                            <span className={`text-[10px] font-bold px-2 py-0.5 rounded-full mb-2 inline-block ${
                                                isRated ? 'bg-slate-200 text-slate-500' : 'bg-indigo-50 text-indigo-600'
                                            }`}>
                                                {majorObj.category}
                                            </span>
                                            <h3 className={`font-bold text-lg flex items-center gap-1 ${
                                                isRated ? 'text-slate-500' : 'text-slate-800'
                                            }`}>
                                                {majorObj.name}
                                                {isRated && <Icons.CheckCircle2 size={14} className="text-indigo-500" />}
                                                {!isRated && <Icons.ChevronRight size={16} className="text-slate-300 group-hover:text-indigo-400" />}
                                            </h3>
                                            </div>
                                            <div className={`flex items-center gap-1 px-2.5 py-1.5 rounded-lg transition-colors duration-300 ${
                                                isRated ? 'bg-amber-100 text-amber-600' : 'bg-slate-50 text-slate-300'
                                            }`}>
                                            <Icons.Star size={16} className={isRated ? "fill-amber-500 text-amber-500" : "fill-none"} />
                                            <span className="font-bold text-sm">{todayRecord.ratings[majorObj.id] || '-'}</span>
                                            </div>
                                        </div>
                                        
                                        <p className={`text-xs mb-4 line-clamp-2 leading-relaxed ${
                                            isRated ? 'text-slate-400' : 'text-slate-500'
                                        }`}>
                                            {majorObj.desc}
                                        </p>
                                        
                                        <div className="pt-3 border-t border-slate-50">
                                            <div className="relative pt-1">
                                            <input
                                                type="range"
                                                min="0"
                                                max="5"
                                                step="1"
                                                value={todayRecord.ratings[majorObj.id] || 0}
                                                onChange={(e) => handleRatingChange(majorObj.id, e.target.value)}
                                                className={`w-full h-2 rounded-lg appearance-none cursor-pointer ${
                                                    isRated ? 'bg-indigo-100 accent-indigo-400' : 'bg-slate-100 accent-indigo-600'
                                                }`}
                                            />
                                            <div className="flex justify-between text-[10px] text-slate-300 mt-2 px-1 font-medium select-none">
                                                <span>0</span>
                                                <span>1</span>
                                                <span>2</span>
                                                <span>3</span>
                                                <span>4</span>
                                                <span>5</span>
                                            </div>
                                            </div>
                                        </div>
                                        </div>
                                    );
                                    })}
                                </div>
                                </div>
                            ))}
                            </div>
                            <div className="h-10"></div>
                        </div>
                        )}

                        {activeTab === 'analyze' && (
                        <div className="animate-fade-in space-y-6 px-5 py-6">
                            <div className="bg-white p-5 rounded-2xl border border-slate-100 shadow-sm">
                            <div className="mb-4">
                                <h2 className="text-lg font-bold flex items-center gap-2 text-slate-800">
                                <Icons.TrendingUp className="text-indigo-600" size={20} />
                                내 관심사 변화
                                </h2>
                            </div>
                             <div className="h-[220px] w-full -ml-2">
                                {/* CUSTOM SVG CHART */}
                                <SimpleLineChart data={chartData} topMajors={topMajors} />
                             </div>
                            {topMajors.length === 0 && <div className="text-center text-xs text-slate-400 py-2">데이터가 없습니다.</div>}
                            </div>
                        </div>
                        )}

                        {activeTab === 'refine' && (
                        <div className="animate-fade-in px-5 py-6 min-h-full flex flex-col">
                            <div className="text-center mb-6">
                            <h2 className="text-xl font-bold text-slate-900 mb-2 flex items-center justify-center gap-2">
                                <Icons.Trophy className="text-amber-400" size={24} />
                                선택과 집중
                            </h2>
                            <p className="text-xs text-slate-500">
                                상위권 학과들을 1:1로 비교하여<br/>최후의 1순위를 결정해보세요.
                            </p>
                            </div>

                            {tournamentState === 'idle' && (
                            <div className="flex-1 flex flex-col items-center justify-center space-y-6">
                                <div className="grid gap-3 w-full">
                                    {topMajors.length < 2 ? (
                                    <div className="text-center py-10 bg-white rounded-xl border border-dashed border-slate-300">
                                        <p className="text-slate-400 text-sm mb-2">후보가 부족합니다.</p>
                                        <p className="text-xs text-slate-400">탐색 탭에서 2개 이상 별점을 매겨주세요.</p>
                                    </div>
                                    ) : (
                                    topMajors.map((major, idx) => (
                                        <div key={major.id} className="bg-white p-4 rounded-xl border border-slate-100 shadow-sm flex items-center justify-between">
                                        <div className="flex items-center gap-3">
                                            <span className="w-6 h-6 rounded-full bg-slate-100 text-slate-500 text-xs flex items-center justify-center font-bold">{idx + 1}</span>
                                            <span className="font-bold text-slate-700">{major.name}</span>
                                        </div>
                                        <span className="text-xs font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded">{major.score}점</span>
                                        </div>
                                    ))
                                    )}
                                </div>

                                {topMajors.length >= 2 && (
                                    <button 
                                    onClick={startTournament}
                                    className="w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold shadow-xl shadow-indigo-200 hover:scale-[1.02] transition-transform flex items-center justify-center gap-2"
                                    >
                                    <Icons.Swords size={20} />
                                    이상형 월드컵 시작 ({Math.pow(2, Math.floor(Math.log2(topMajors.length)))}강)
                                    </button>
                                )}
                            </div>
                            )}

                            {tournamentState === 'playing' && (
                            <div className="flex-1 flex flex-col min-h-0">
                                <div className="text-center mb-4 flex-shrink-0">
                                <span className="bg-slate-900 text-white px-3 py-1 rounded-full text-xs font-bold">
                                    {candidates.length === 2 ? "결승전" : `${candidates.length}강`} - {Math.floor(currentMatchIndex / 2) + 1}경기
                                </span>
                                </div>
                                
                                <div className="flex-1 flex flex-col gap-4">
                                    {[candidates[currentMatchIndex], candidates[currentMatchIndex + 1]].map((major, i) => (
                                    <button
                                        key={major.id}
                                        onClick={() => selectWinner(major)}
                                        className={`relative bg-white rounded-3xl border-2 border-slate-100 shadow-lg p-6 flex flex-col items-center justify-center gap-3 transition-all hover:border-indigo-500 hover:scale-[1.02] group active:scale-95 w-full ${
                                        i === 0 ? 'hover:bg-indigo-50' : 'hover:bg-amber-50'
                                        }`}
                                        style={{ minHeight: '220px', flex: '1 0 auto' }}
                                    >
                                        <div className="text-xs font-bold text-slate-400 bg-slate-100 px-3 py-1 rounded-full">
                                        {major.category}
                                        </div>
                                        <h3 className="text-2xl font-bold text-slate-800 break-keep text-center">
                                        {major.name}
                                        </h3>
                                        <p className="text-xs text-slate-400 line-clamp-2 text-center px-4">
                                        {major.desc}
                                        </p>
                                        <div className="absolute top-4 right-4 text-xs font-bold text-slate-300">
                                        ★ {major.score}
                                        </div>
                                    </button>
                                    ))}
                                </div>
                                <div className="text-center text-xs text-slate-400 mt-4 flex-shrink-0">
                                둘 중 더 마음이 가는 학과를 선택하세요!
                                </div>
                            </div>
                            )}

                            {tournamentState === 'finished' && winner && (
                            <div className="flex-1 flex flex-col items-center animate-fade-in w-full overflow-hidden">
                                <div className="flex-1 w-full overflow-y-auto scrollbar-hide pb-6">
                                    <div className="text-center mt-6 mb-8">
                                    <Icons.Crown size={64} className="text-amber-400 mb-4 mx-auto drop-shadow-lg" />
                                    <h3 className="text-slate-500 text-sm font-bold mb-2">최종 우승</h3>
                                    <h2 className="text-3xl font-bold text-slate-900 mb-3">{winner.name}</h2>
                                    <span className="bg-indigo-50 text-indigo-600 px-4 py-1.5 rounded-full text-sm font-bold">
                                        {winner.category}
                                    </span>
                                    </div>

                                    <div className="w-full px-5">
                                    <h3 className="text-sm font-bold text-slate-500 mb-3 flex items-center gap-2">
                                        <Icons.Trophy size={16} />
                                        최종 순위 리스트
                                    </h3>
                                    <div className="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                                        <div className="flex items-center p-4 border-b border-slate-100 bg-amber-50/50">
                                            <span className="w-8 font-bold text-amber-500 text-lg text-center">1</span>
                                            <div className="flex-1">
                                                <span className="font-bold text-slate-800 block">{winner.name}</span>
                                                <span className="text-[10px] text-slate-400">{winner.category}</span>
                                            </div>
                                            <Icons.Crown size={16} className="text-amber-400" />
                                        </div>
                                        
                                        {[...eliminatedCandidates].reverse().map((major, idx) => (
                                            <div key={major.id} className="flex items-center p-4 border-b border-slate-100 last:border-0">
                                                <span className={`w-8 font-bold text-lg text-center ${idx === 0 ? 'text-slate-500' : 'text-slate-300'}`}>
                                                    {idx + 2}
                                                </span>
                                                <div className="flex-1">
                                                    <span className={`font-medium block ${idx === 0 ? 'text-slate-700' : 'text-slate-500'}`}>{major.name}</span>
                                                    <span className="text-[10px] text-slate-400">{major.category}</span>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                    </div>
                                </div>

                                <div className="flex gap-3 w-full px-5 py-4 bg-white border-t border-slate-100">
                                <button 
                                    onClick={resetTournament}
                                    className="flex-1 py-3 bg-slate-100 text-slate-600 rounded-xl font-bold text-sm hover:bg-slate-200"
                                >
                                    다시 하기
                                </button>
                                <button 
                                    onClick={() => setSelectedMajor(winner)}
                                    className="flex-1 py-3 bg-indigo-600 text-white rounded-xl font-bold text-sm shadow-lg hover:bg-indigo-700"
                                >
                                    우승 학과 상세
                                </button>
                                </div>
                            </div>
                            )}
                        </div>
                        )}
                        
                        <div className="h-4"></div>
                    </main>

                    <nav className="bg-white border-t border-slate-100 absolute bottom-0 w-full px-6 py-3 flex justify-between items-center pb-6 md:pb-3 z-30">
                    {[
                        { id: 'explore', icon: Icons.Search, label: '탐색' },
                        { id: 'analyze', icon: Icons.TrendingUp, label: '분석' },
                        { id: 'refine', icon: Icons.Trophy, label: '선택' },
                    ].map(item => (
                        <button
                        key={item.id}
                        onClick={() => setActiveTab(item.id)}
                        className={`flex flex-col items-center gap-1 min-w-[60px] transition-colors ${
                            activeTab === item.id ? 'text-indigo-600' : 'text-slate-400 hover:text-slate-600'
                        }`}
                        >
                        <item.icon size={24} strokeWidth={activeTab === item.id ? 2.5 : 2} />
                        <span className="text-[10px] font-medium">{item.label}</span>
                        </button>
                    ))}
                    </nav>

                    {toast && (
                    <div className={`absolute top-20 left-1/2 transform -translate-x-1/2 px-4 py-2 rounded-full shadow-lg text-white font-medium text-xs animate-fade-in z-50 whitespace-nowrap flex items-center gap-2 ${
                        toast.type === 'error' ? 'bg-red-500' : 'bg-slate-800/90 backdrop-blur'
                    }`}>
                        {toast.type === 'success' && <Icons.CheckCircle2 size={14} className="text-green-400"/>}
                        {toast.msg}
                    </div>
                    )}

                    {selectedMajor && (
                    <div className="absolute inset-0 z-50 bg-white flex flex-col animate-fade-in">
                        <div className="px-5 py-4 border-b border-slate-100 flex items-center justify-between bg-white sticky top-0">
                        <button onClick={() => setSelectedMajor(null)} className="p-2 -ml-2 text-slate-500 hover:bg-slate-100 rounded-full">
                            <Icons.ChevronRight size={24} className="rotate-180" />
                        </button>
                        <h2 className="font-bold text-lg text-slate-900 truncate px-4">{selectedMajor.name}</h2>
                        <button onClick={() => setSelectedMajor(null)} className="p-2 -mr-2 text-slate-400 hover:text-slate-600">
                            <Icons.X size={24} />
                        </button>
                        </div>

                        <div className="flex-1 overflow-y-auto p-6 scrollbar-hide">
                        <span className="inline-block bg-indigo-50 text-indigo-600 px-3 py-1 rounded-full text-xs font-bold mb-4">
                            {selectedMajor.category}
                        </span>
                        
                        <h1 className="text-2xl font-bold text-slate-900 mb-6 leading-tight">
                            {selectedMajor.name},<br/>
                            어떤 곳인가요?
                        </h1>

                        {selectedMajor.details ? (
                            <div className="space-y-6">
                            <div className="bg-slate-50 rounded-2xl p-5 border border-slate-100">
                                <h3 className="text-sm font-bold text-indigo-700 mb-2 flex items-center gap-2">
                                <Icons.BookOpen size={18} />
                                학과 소개
                                </h3>
                                <p className="text-slate-700 text-sm leading-relaxed">{selectedMajor.details.intro}</p>
                            </div>

                            <div className="bg-white rounded-2xl p-5 border border-indigo-100 shadow-sm">
                                <h3 className="text-sm font-bold text-indigo-700 mb-2 flex items-center gap-2">
                                <Icons.User size={18} />
                                이런 학생에게 딱!
                                </h3>
                                <p className="text-slate-700 text-sm leading-relaxed">{selectedMajor.details.fit}</p>
                            </div>

                            <div className="bg-amber-50 rounded-2xl p-5 border border-amber-100">
                                <h3 className="text-sm font-bold text-amber-700 mb-2 flex items-center gap-2">
                                <Icons.HelpCircle size={18} />
                                전공에 대한 오해와 진실
                                </h3>
                                <p className="text-slate-700 text-sm leading-relaxed">{selectedMajor.details.truth}</p>
                            </div>

                            <div className="bg-white rounded-2xl p-5 border border-slate-100">
                                <h3 className="text-sm font-bold text-slate-700 mb-3 flex items-center gap-2">
                                <Icons.Map size={18} />
                                알쏭달쏭 전공과목 & 로드맵
                                </h3>
                                <ul className="space-y-2">
                                {selectedMajor.details.roadmap.map((item, i) => (
                                    <li key={i} className="text-sm text-slate-600 flex items-start gap-2">
                                    <span className="w-1.5 h-1.5 rounded-full bg-indigo-400 mt-1.5 flex-shrink-0"></span>
                                    <span>{item}</span>
                                    </li>
                                ))}
                                </ul>
                            </div>

                            <div className="bg-indigo-50/50 rounded-2xl p-5 border border-indigo-100">
                                <h3 className="text-sm font-bold text-indigo-700 mb-2 flex items-center gap-2">
                                <Icons.Briefcase size={18} />
                                졸업 후의 진로
                                </h3>
                                <p className="text-slate-700 text-sm leading-relaxed">{selectedMajor.details.career}</p>
                            </div>
                            </div>
                        ) : (
                            <div className="text-center py-12 bg-slate-50 rounded-2xl border border-dashed border-slate-200">
                            <Icons.Lightbulb size={32} className="mx-auto text-slate-300 mb-3" />
                            <p className="text-slate-500 font-medium">상세 정보 업데이트 예정입니다.</p>
                            <p className="text-xs text-slate-400 mt-1">조금만 기다려주세요!</p>
                            </div>
                        )}

                        <div className="mt-8 pt-6 border-t border-slate-100">
                            <div className="flex justify-between items-center mb-4">
                            <span className="font-bold text-slate-900">이 학과에 대한 내 관심도는?</span>
                            <div className="flex items-center gap-1 text-amber-500">
                                <Icons.Star size={20} fill="currentColor" />
                                <span className="text-xl font-bold">{todayRecord.ratings[selectedMajor.id] || 0}</span>
                            </div>
                            </div>
                            <input
                            type="range"
                            min="0"
                            max="5"
                            step="1"
                            value={todayRecord.ratings[selectedMajor.id] || 0}
                            onChange={(e) => handleRatingChange(selectedMajor.id, e.target.value)}
                            className="w-full h-3 bg-slate-100 rounded-lg appearance-none cursor-pointer accent-indigo-600"
                            />
                            <div className="flex justify-between text-xs text-slate-400 mt-2 font-medium">
                            <span>관심없음</span>
                            <span>매우관심</span>
                            </div>
                        </div>
                        </div>

                        <div className="p-5 border-t border-slate-100 bg-white">
                        <button 
                            onClick={() => setSelectedMajor(null)}
                            className="w-full py-3.5 bg-slate-900 text-white rounded-xl font-bold text-sm shadow-lg hover:bg-slate-800 transition-colors"
                        >
                            확인 완료
                        </button>
                        </div>
                    </div>
                    )}

                    {showProfileModal && (
                        <div className="absolute inset-0 z-50 bg-black/50 flex items-end sm:items-center justify-center animate-fade-in p-4">
                            <div className="bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl relative">
                                <button 
                                    onClick={() => setShowProfileModal(false)}
                                    className="absolute top-4 right-4 text-slate-400 hover:text-slate-600"
                                >
                                    <Icons.X size={24} />
                                </button>
                                
                                <div className="text-center mb-8">
                                    <div className="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                        <Icons.User size={32} className="text-slate-400" />
                                    </div>
                                    <h2 className="text-xl font-bold text-slate-900">마이페이지</h2>
                                    <p className="text-xs text-slate-500">내 기록을 관리하세요</p>
                                </div>

                                <div className="space-y-4">
                                    <div className="bg-slate-50 p-4 rounded-xl border border-slate-100">
                                        <h3 className="text-sm font-bold text-slate-700 mb-2 flex items-center gap-2">
                                            <Icons.Activity size={16}/> 내 활동 요약
                                        </h3>
                                        <div className="text-xs text-slate-500 flex justify-between">
                                            <span>평가한 학과 수</span>
                                            <span className="font-bold text-indigo-600">{progressStats.ratedCount}개</span>
                                        </div>
                                    </div>

                                    <div className="grid gap-2">
                                        <button 
                                            onClick={handleResetToday}
                                            className="w-full py-3 bg-white border border-slate-200 text-slate-600 rounded-xl font-bold text-sm hover:bg-slate-50 transition-colors flex items-center justify-center gap-2"
                                        >
                                            <Icons.RotateCcw size={18} />
                                            오늘 기록만 초기화
                                        </button>

                                        <button 
                                            onClick={handleResetData}
                                            className="w-full py-3 bg-red-50 text-red-600 rounded-xl font-bold text-sm hover:bg-red-100 transition-colors flex items-center justify-center gap-2"
                                        >
                                            <Icons.Trash2 size={18} />
                                            모든 기록 초기화
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
